

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Problem Setup &mdash; Nek5000 17.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Nek5000 17.0 documentation" href="index.html"/>
        <link rel="next" title="Theory" href="theory.html"/>
        <link rel="prev" title="Overlapping Overset Grids" href="tutorials/neknek.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Nek5000
          

          
          </a>

          
            
            
              <div class="version">
                17.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Problem Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#session-name">SESSION.NAME</a></li>
<li class="toctree-l2"><a class="reference internal" href="#par">par</a></li>
<li class="toctree-l2"><a class="reference internal" href="#re2">re2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#header">Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#element-data">Element data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#curved-sides">Curved Sides</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boundaries">Boundaries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#usr">usr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#uservp">uservp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#userf">userf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#userq">userq</a></li>
<li class="toctree-l3"><a class="reference internal" href="#userbc">userbc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#useric">useric</a></li>
<li class="toctree-l3"><a class="reference internal" href="#userchk">userchk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#userqtl">userqtl</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usrdat">usrdat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usrdat2">usrdat2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usrdat3">usrdat3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#size">SIZE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#map-ma2">map/ma2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#f-05d">f%05d</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data">Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#boundary-conditions">Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fluid-velocity">Fluid Velocity</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passive-scalars-and-temperature">Passive scalars and Temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passive-scalars">Passive scalars</a></li>
<li class="toctree-l3"><a class="reference internal" href="#internal-boundary-conditions">Internal Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#history-points">History Points</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Nek5000</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Problem Setup</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/case_files.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="problem-setup">
<span id="case-files"></span><h1>Problem Setup<a class="headerlink" href="#problem-setup" title="Permalink to this headline">¶</a></h1>
<p>Each simulation is defined by six <em>required</em> case files:</p>
<ul class="simple">
<li>SESSION.NAME</li>
<li>par       (runtime parameters)</li>
<li>re2       (mesh and boundaries)</li>
<li>usr       (user defined functions for inital/boundary condition etc.)</li>
<li>SIZE      (parameters for static memory allocation)</li>
<li>map/ma2   (element processes mapping)</li>
</ul>
<p>Additional <em>optional</em> case files may be generated or included:</p>
<ul class="simple">
<li>f%05d     (solution data)</li>
<li>his       (probing point data)</li>
</ul>
<div class="section" id="session-name">
<span id="case-files-session"></span><h2>SESSION.NAME<a class="headerlink" href="#session-name" title="Permalink to this headline">¶</a></h2>
<p>To run Nek5000, each simulation must have a <code class="docutils literal"><span class="pre">SESSION.NAME</span></code> file.
This file is read in by the code and gives the path to the relevant files describing the structure and parameters of the simulation.
The <code class="docutils literal"><span class="pre">SESSION.NAME</span></code> file is a file that contains the name of the simulation and the full path to supporting files.
For example, to run the eddy example from the repository, the <code class="docutils literal"><span class="pre">SESSION.NAME</span></code> file would look like:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>eddy_uv
/home/user_name/Nek5000/short_tests/eddy/
</pre></div>
</div>
<p>Note that this file is generated automatically by the <code class="docutils literal"><span class="pre">nek</span></code>, <code class="docutils literal"><span class="pre">nekb</span></code>, <code class="docutils literal"><span class="pre">nekmpi</span></code> and <code class="docutils literal"><span class="pre">nekbmpi</span></code> scripts at runtime.</p>
</div>
<div class="section" id="par">
<span id="case-files-par"></span><h2>par<a class="headerlink" href="#par" title="Permalink to this headline">¶</a></h2>
<p>The simulation paramaters are defined in the <code class="docutils literal"><span class="pre">.par</span></code> file.
The keys are grouped in different sections and a specific value is assigned to each key.
The <code class="docutils literal"><span class="pre">.par</span></code> file follows the structure exemplified below.</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>#
# nek parameter file
#

[SECTION]
key = value
...

[SECTION]
key = value
...
</pre></div>
</div>
<p>The sections are:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">GENERAL</span></code> (mandatory)</li>
<li><code class="docutils literal"><span class="pre">PROBLEMTYPE</span></code></li>
<li><code class="docutils literal"><span class="pre">MESH</span></code></li>
<li><code class="docutils literal"><span class="pre">VELOCITY</span></code></li>
<li><code class="docutils literal"><span class="pre">PRESSURE</span></code> (required for velocity)</li>
<li><code class="docutils literal"><span class="pre">TEMPERATURE</span></code></li>
<li><code class="docutils literal"><span class="pre">SCALAR%%</span></code></li>
<li><code class="docutils literal"><span class="pre">CVODE</span></code></li>
</ul>
<p>When scalars are used, the keys of each scalar are defined under the section <code class="docutils literal"><span class="pre">SCALAR%%</span></code> varying
between <code class="docutils literal"><span class="pre">SCALAR01</span></code> and <code class="docutils literal"><span class="pre">SCALAR99</span></code>. The descripton of the keys of each section is given in the
following tables (all keys/values are case insensitive). The value assigned to each key can be a
user input (e.g. a &lt;real&gt; value) or one of the avaliable options listed in the tables below.
Values in parentheses denote the default value.</p>
<span id="tab-generalparams"></span><table border="1" class="docutils" id="id3">
<caption><span class="caption-number">Table 1 </span><span class="caption-text"><code class="docutils literal"><span class="pre">GENERAL</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="28%" />
<col width="19%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">startFrom</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;string&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Absolute/relative path of the field file</div>
<div class="line">to restart the simulation from</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">stopAt</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(numSteps)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">endTime</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Stop mode</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">endTime</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Final physical time at which we want to</div>
<div class="line">our simulation to stop</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">numSteps</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Number of time steps instead of specifying</div>
<div class="line">final physical time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dt</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies the step size or in case of a</div>
<div class="line">a variable time step the maximum step size</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">variableDT</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls if the step size will be adjusted</div>
<div class="line">to match the targetCFL</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">targetCFL</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sets stability/target CFL number for</div>
<div class="line">OIFS or variable time steps</div>
<div class="line">(fixed to 0.5 for standard extrapolation</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">writeControl</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(timeStep)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">runTime</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies whether checkpointing is based</div>
<div class="line">on number of time steps or physical time</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">writeInterval</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Checkpoint frequency in time steps or</div>
<div class="line">physical time</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">filtering</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(none)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">explicit</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">hpfrt</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies the filtering method</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">filterCutoffRatio</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Ratio of modeal modes not affected</div>
<div class="line">Use i.e. for stabilization or LES 0.9/0.65</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">filterWeight</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sets the filter strength of transfer</div>
<div class="line">function of the last mode (explicit) or the</div>
<div class="line">relaxation parameter in case of hpfrt</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">writeDoublePrecision</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">no</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(yes)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sets the precision of the field files</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">writeNFiles</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(1)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sets the number of output files</div>
<div class="line">By default a parallel shared file is used</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dealiasing</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">no</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(yes)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enable/diasble over-integration</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">timeStepper</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">BDF1</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(BDF2)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">BDF3</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Time integration order</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">extrapolation</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(standard)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">OIFS</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Extrapolation method</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">optLevel</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(2)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Optimization level</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">logLevel</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(2)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Verbosity level</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">userParam%%</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">User parameter (can be accessed through</div>
<div class="line">uparam(%) array in <code class="docutils literal"><span class="pre">.usr</span></code></div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-probtypeparams"></span><table border="1" class="docutils" id="id4">
<caption><span class="caption-number">Table 2 </span><span class="caption-text"><code class="docutils literal"><span class="pre">PROBLEMTYPE</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="28%" />
<col width="21%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">equation</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(incompNS)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">lowMachNS</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">steadyStokes</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">incompLinNS</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">incompLinAdjNS</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">incompMHD</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">compNS</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specifies equation type</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">axiSymmetry</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Axisymmetric problem</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">swirl</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enable axisymmetric azimuthal velocity</div>
<div class="line">component (stored in temperature field</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">cyclicBoundaries</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Sets cyclic periodic boundaries</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">numberOfPerturbations</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(1)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Number of perturbations for linearized NS</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">solveBaseFlow</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Solve for base flow in case of linearized NS</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">variableProperties</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enable variable transport properties</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">stressFormulation</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enable stress formulation</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">dp0dt</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Enable time-varying thermodynamic pressure</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-fieldparams"></span><table border="1" class="docutils" id="id5">
<caption><span class="caption-number">Table 3 </span><span class="caption-text"><code class="docutils literal"><span class="pre">COMMON</span></code> keys for all field variables in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="26%" />
<col width="18%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">residualTol</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Residual tolerance used by solver (not for CVODE)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">residualProj</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls the residual projection</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">writeToFieldFile</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">no</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(yes)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls if fields will be written on output</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-meshparams"></span><table border="1" class="docutils" id="id6">
<caption><span class="caption-number">Table 4 </span><span class="caption-text"><code class="docutils literal"><span class="pre">MESH</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id6" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="26%" />
<col width="18%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">motion</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(none)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">user</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">elasticity</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Mesh motion solver</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">viscosity</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(0.4)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Diffusivity for elasticity solver</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">numberOfBCFields</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(nfields)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Number of field variables which have a boundary</div>
<div class="line-block">
<div class="line">condition in <code class="docutils literal"><span class="pre">.re2</span></code> file</div>
</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">firstBCFieldIndex</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(1</span> <span class="pre">or</span> <span class="pre">2)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Field index of the first BC specified in <code class="docutils literal"><span class="pre">.re2</span></code></div>
<div class="line">file</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-velocityparams"></span><table border="1" class="docutils" id="id7">
<caption><span class="caption-number">Table 5 </span><span class="caption-text"><code class="docutils literal"><span class="pre">VELOCITY</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id7" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="29%" />
<col width="16%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">viscosity</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Dynamic viscosity</div>
<div class="line">A negative value sets the Reynolds number</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">density</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Density</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-pressureparams"></span><table border="1" class="docutils" id="id8">
<caption><span class="caption-number">Table 6 </span><span class="caption-text"><code class="docutils literal"><span class="pre">PRESSURE</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="28%" />
<col width="20%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">preconditioner</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(semg_xxt)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">semg_amg</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Preconditioning method</div>
<div class="line">First time usage of AMG will write three</div>
<div class="line">dump files to disc. Subsequently please run</div>
<div class="line">the amg_hypre tool to create the setup files</div>
<div class="line">required for the AMG solver initialization</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="id1"></span><table border="1" class="docutils" id="id9">
<caption><span class="caption-number">Table 7 </span><span class="caption-text"><code class="docutils literal"><span class="pre">COMMON</span></code> keys for temperature and scalar fields in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id9" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="17%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">solver</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(helm)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">cvode</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">none</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Solver for scalar</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">advection</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">no</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(yes)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls if advection is present</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">absoluteTol</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Absolute tolerance used by CVODE</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-temperatureparams"></span><table border="1" class="docutils" id="id10">
<caption><span class="caption-number">Table 8 </span><span class="caption-text"><code class="docutils literal"><span class="pre">TEMPERATURE</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="16%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">ConjugateHeatTransfer</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(no)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">yes</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls conjugate heat transfer</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">conductivity</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Thermal conductivity</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">rhoCp</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Product of density and heat capacity</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>Note: <code class="docutils literal"><span class="pre">[TEMPERATURE]</span> <span class="pre">solver</span> <span class="pre">=</span> <span class="pre">none</span></code> is incompatible with <code class="docutils literal"><span class="pre">[PROBLEMTYPE]</span> <span class="pre">equation</span> <span class="pre">=</span> <span class="pre">lowMachNS</span></code> without defining a custom thermal divergence in the <code class="docutils literal"><span class="pre">usr</span></code> file.</p>
<span id="tab-scalarparams"></span><table border="1" class="docutils" id="id11">
<caption><span class="caption-number">Table 9 </span><span class="caption-text"><code class="docutils literal"><span class="pre">SCALAR%%</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="19%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">density</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Density</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">diffusivity</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Diffusivity</div>
</div>
</td>
</tr>
</tbody>
</table>
<span id="tab-cvodeparams"></span><table border="1" class="docutils" id="id12">
<caption><span class="caption-number">Table 10 </span><span class="caption-text"><code class="docutils literal"><span class="pre">CVODE</span></code> keys in the <code class="docutils literal"><span class="pre">.par</span></code> file</span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="30%" />
<col width="18%" />
<col width="52%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Key</th>
<th class="head"><div class="first last line-block">
<div class="line">Value(s)</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Description</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">relativeTol</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Relative tolerance (applies to all scalars)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">stiff</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">no</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">(yes)</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Controls if BDF or Adams Moulton is used</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">preconditioner</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">(none)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">user</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Preconditioner method</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">dtMax</span></code></td>
<td><div class="first last line-block">
<div class="line"><code class="docutils literal"><span class="pre">&lt;real&gt;</span></code></div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Maximum internal step size</div>
<div class="line">Controls splitting error of velocity</div>
<div class="line">scalar coupling (e.g. set to 1-4 dt)</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="re2">
<span id="case-files-re2"></span><h2>re2<a class="headerlink" href="#re2" title="Permalink to this headline">¶</a></h2>
<p>Stores the mesh and boundary condition.</p>
<p>TODO: Update to re2</p>
<div class="section" id="header">
<h3>Header<a class="headerlink" href="#header" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The 80 byte ASCI header of the file has the following representation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#v002     200  3     100 hdr</span>
</pre></div>
</div>
<p>The header states first how many elements are available in total (200), what
dimension is the the problem (here three dimensional), and how many elements
are in the fluid mesh (100).</p>
</div></blockquote>
</div>
<div class="section" id="element-data">
<h3>Element data<a class="headerlink" href="#element-data" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><blockquote>
<div><span id="tab-element"></span><table border="1" class="docutils" id="id13">
<caption><span class="caption-number">Table 11 </span><span class="caption-text">Geometry description in <code class="docutils literal"><span class="pre">.rea</span></code> file</span><a class="headerlink" href="#id13" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="31%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="5"><code class="docutils literal"><span class="pre">ELEMENT</span> <span class="pre">1</span> <span class="pre">[</span> <span class="pre">1A]</span> <span class="pre">GROUP</span> <span class="pre">0</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="5"><code class="docutils literal"><span class="pre">Face</span> <span class="pre">{1,2,3,4}</span></code></td>
</tr>
<tr class="row-odd"><td><span class="math">\(x_{1,\ldots,4}=\)</span></td>
<td>0.000000E+00</td>
<td>0.171820E+00</td>
<td>0.146403E+00</td>
<td>0.000000E+00</td>
</tr>
<tr class="row-even"><td><span class="math">\(y_{1,\ldots,4}=\)</span></td>
<td>0.190000E+00</td>
<td>0.168202E+00</td>
<td>0.343640E+00</td>
<td>0.380000E+00</td>
</tr>
<tr class="row-odd"><td><span class="math">\(z_{1,\ldots,4}=\)</span></td>
<td>0.000000E+00</td>
<td>0.000000E+00</td>
<td>0.000000E+00</td>
<td>0.000000E+00</td>
</tr>
<tr class="row-even"><td colspan="5"><code class="docutils literal"><span class="pre">Face</span> <span class="pre">{5,6,7,8}</span></code></td>
</tr>
<tr class="row-odd"><td><span class="math">\(x_{5,\ldots,8}=\)</span></td>
<td>0.000000E+00</td>
<td>0.171820E+00</td>
<td>0.146403E+00</td>
<td>0.000000E+00</td>
</tr>
<tr class="row-even"><td><span class="math">\(y_{5,\ldots,8}=\)</span></td>
<td>0.190000E+00</td>
<td>0.168202E+00</td>
<td>0.343640E+00</td>
<td>0.380000E+00</td>
</tr>
<tr class="row-odd"><td><span class="math">\(z_{5,\ldots,8}=\)</span></td>
<td>0.250000E+00</td>
<td>0.250000E+00</td>
<td>0.250000E+00</td>
<td>0.250000E+00</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Following the header, all elements are listed. The fluid elements are listed
first, followed by all solid elements if present.</p>
<p>The data following the header is formatted as shown in <a class="reference internal" href="#tab-element"><span class="std std-numref">Table 11</span></a>. This provides all the coordinates of an element for top and bottom faces. The numbering of the vertices is shown in Fig. <a class="reference internal" href="#fig-elorder"><span class="std std-numref">Fig. 5</span></a>. The header for each element as in <a class="reference internal" href="#tab-element"><span class="std std-numref">Table 11</span></a>, i.e. <code class="docutils literal"><span class="pre">[1A]</span> <span class="pre">GROUP</span></code> is reminiscent of older Nek5000 format and does not impact the mesh generation at this stage.</p>
<blockquote>
<div><div class="align-center figure" id="id14">
<span id="fig-elorder"></span><img alt="rea-geometry" src="_images/3dcube_1.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">Geometry description in <code class="docutils literal"><span class="pre">.rea</span></code> file (sketch of one element ordering - Preprocessor
corner notation)</span></p>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="curved-sides">
<h3>Curved Sides<a class="headerlink" href="#curved-sides" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This section describes the curvature of the elements. It is expressed as deformation of the linear elements.
Therefore, if no elements are curved (if only linear elements are present) the section remains empty.</p>
<p>The section header may look like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">640</span> <span class="n">Curved</span> <span class="n">sides</span> <span class="n">follow</span> <span class="n">IEDGE</span><span class="p">,</span><span class="n">IEL</span><span class="p">,</span><span class="n">CURVE</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">CCURVE</span>
</pre></div>
</div>
<p>Curvature information is provided by edge and element. Therefore up to 12 curvature entries can be present for each element.
Only non-trivial curvature data needs to be provided, i.e., edges that correspond to linear elements, since they have no curvature, will have no entry.
The formatting for the curvature data is provided in <a class="reference internal" href="#tab-midside"><span class="std std-numref">Table 12</span></a>.</p>
<blockquote>
<div><span id="tab-midside"></span><table border="1" class="docutils" id="id15">
<caption><span class="caption-number">Table 12 </span><span class="caption-text">Curvature information specification</span><a class="headerlink" href="#id15" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">IEDGE</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">IEL</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CURVE(1)</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CURVE(2)</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CURVE(3)</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CURVE(4)</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CURVE(5)</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CCURVE</span></code></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>9</td>
<td>2</td>
<td>0.125713</td>
<td>-0.992067</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>m</td>
</tr>
<tr class="row-odd"><td>10</td>
<td>38</td>
<td>0.125713</td>
<td>-0.992067</td>
<td>3.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>m</td>
</tr>
<tr class="row-even"><td>1</td>
<td>40</td>
<td>1.00000</td>
<td>0.000000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>C</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>There are several types of possible curvature information represented by <code class="docutils literal"><span class="pre">CCURVE</span></code>. This include:</p>
<ul class="simple">
<li>‘C’ stands for circle and is given by the radius of the circle,  in <code class="docutils literal"><span class="pre">CURVE(1)</span></code>, all other compoentns of the <code class="docutils literal"><span class="pre">CURVE</span></code> array are not used but need to be present.</li>
<li>‘s’ stands for sphere and is given by the radius and the center of the sphere, thus filling the first 4 components of the <code class="docutils literal"><span class="pre">CURVE</span></code> array. The fifth component needs to be present but is not utilized.</li>
<li>‘m’ is given by the coordinates of the midside-node, thus using the first 3 components of the <code class="docutils literal"><span class="pre">CURVE</span></code> array, and leads to a second order reconstruction of the face.  The fourth and fifth components need to be present but are not utilized.</li>
</ul>
<p>Both ‘C’ and ‘s’ types allow for a surface of as high order as the polynomial used in the spectral method, since they have an underlying analytical description, any circle arc can be fully determined by the radius and end points. However for the ‘m’ curved element descriptor the surface can be reconstructed only up to second order. This can be later updated to match the high-order polynomial after the GLL points have been distributed across the boundaries. This is the only general mean to describe curvature currrently in Nek5000 and corresponds to a HEX20 representation.</p>
<blockquote>
<div><div class="align-center figure" id="id16">
<span id="fig-edges"></span><img alt="edge-numbering" src="_images/3dcube.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Edge numbering in <code class="docutils literal"><span class="pre">.rea</span></code> file, the edge number is in between parenthesis. The other
numbers represent vertices.</span></p>
</div>
</div></blockquote>
<div class="align-center figure" id="id17">
<span id="fig-ex2"></span><img alt="edge-numbering" src="_images/modified1.png" />
<p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Example mesh - with curvature. Circular dots represent example midsize points.</span></p>
</div>
</div></blockquote>
</div>
<div class="section" id="boundaries">
<h3>Boundaries<a class="headerlink" href="#boundaries" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Boundaries are specified for each field in sequence: velocity, temperature and passive scalars. The section header for each field will be as follows (example for the velocity):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*****</span> <span class="n">FLUID</span>   <span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span> <span class="o">*****</span>
</pre></div>
</div>
<p>and the data is stored as illustarted in <a class="reference internal" href="#tab-bcs"><span class="std std-numref">Table 13</span></a>. For each field boundary conditions are listed for each face of each element.</p>
<p>Boundary conditions are given in order per each element, see <a class="reference internal" href="#tab-bcs"><span class="std std-numref">Table 13</span></a> column <code class="docutils literal"><span class="pre">IEL</span></code>, and faces listed in ascending order 1-6 in column <code class="docutils literal"><span class="pre">IFACE</span></code>. Note that the header in <a class="reference internal" href="#tab-bcs"><span class="std std-numref">Table 13</span></a> does not appear in the actual <code class="docutils literal"><span class="pre">.rea</span></code>.</p>
<p>The ordering for faces each element is shown in <a class="reference internal" href="#fig-forder"><span class="std std-numref">Fig. 8</span></a>. A total equivalent to <span class="math">\(6N_{field}\)</span> boundary conditions are listed for each field, where <span class="math">\(N_{field}\)</span> is the number of elements for the specific field. <span class="math">\(N_{field}\)</span> is equal to the total number of fluid elements for the velocity and equal to the total number of elements (including solid elements) for temperature. For the passive scalars it will depend on the specific choice, but typically scalars are solved on the temeprature mesh (solid+fluid).</p>
<blockquote>
<div><div class="align-center figure" id="id18">
<span id="fig-forder"></span><img alt="edge-numbering" src="_images/3dcube_2.png" />
<p class="caption"><span class="caption-number">Fig. 8 </span><span class="caption-text">Face ordering for each element.</span></p>
</div>
</div></blockquote>
<p>Each BC letter condition is formed by three characters. Common BCs include:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">E</span></code> - internal boundary condition. No additional information needs to be provided.</li>
<li><code class="docutils literal"><span class="pre">SYM</span></code> - symmetry boundary condition. No additional information needs to be provided.</li>
<li><code class="docutils literal"><span class="pre">P</span></code> - periodic boundary conditions,  which indicates that an element face is connected to another element to establish a periodic BC. The connecting element and face need be  to specified in <code class="docutils literal"><span class="pre">CONN-IEL</span></code> and <code class="docutils literal"><span class="pre">CONN-IFACE</span></code>.</li>
<li><code class="docutils literal"><span class="pre">v</span></code> - imposed velocity boundary conditions (inlet). The value is specified in the user subroutines. No additional information needs to be provided in the <code class="docutils literal"><span class="pre">.rea</span></code> file.</li>
<li><code class="docutils literal"><span class="pre">W</span></code> - wall boundary condition (no-slip) for the velocity. No additional information needs to be provided.</li>
<li><code class="docutils literal"><span class="pre">O</span></code> - outlet boundary condition (velocity). No additional information needs to be provided.</li>
<li><code class="docutils literal"><span class="pre">t</span></code> - imposed temperature  boundary conditions (inlet). The value is specified in the user subroutines. No additional information needs to be provided in the <code class="docutils literal"><span class="pre">.rea</span></code> file.</li>
<li><code class="docutils literal"><span class="pre">f</span></code> - imposed heat flux  boundary conditions (temperature). The value is specified in the user subroutines. No additional information needs to be provided in the <code class="docutils literal"><span class="pre">.rea</span></code> file.</li>
<li><code class="docutils literal"><span class="pre">I</span></code> - adiabatic boundary conditions (temeperature). No additional information needs to be provided.</li>
</ul>
<p>Many of the BCs support either a constant specification or a user defined specification which may be an arbitrary function.   For example, a constant Dirichlet BC for velocity is specified by <code class="docutils literal"><span class="pre">V</span></code>, while a user defined BC is specified by <code class="docutils literal"><span class="pre">v</span></code>.   This upper/lower-case distinction is  used for all cases.   There are about 70 different types of boundary conditions in all, including free-surface, moving boundary, heat flux, convective cooling, etc. The above cases are just the most used types.</p>
<blockquote>
<div><span id="tab-bcs"></span><table border="1" class="docutils" id="id19">
<caption><span class="caption-number">Table 13 </span><span class="caption-text">Formatting of boundary conditions input.</span><a class="headerlink" href="#id19" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="13%" />
<col width="16%" />
<col width="19%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><code class="docutils literal"><span class="pre">CBC</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">IEL</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">IFACE</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CONN-IEL</span></code></th>
<th class="head"><code class="docutils literal"><span class="pre">CONN-IFACE</span></code></th>
<th class="head">&#160;</th>
<th class="head">&#160;</th>
<th class="head">&#160;</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>E</td>
<td>1</td>
<td>1</td>
<td>4.00000</td>
<td>3.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
</tr>
<tr class="row-even"><td>W</td>
<td>5</td>
<td>3</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
<td><code class="docutils literal"><span class="pre">..</span></code></td>
</tr>
<tr class="row-even"><td>P</td>
<td>23</td>
<td>5</td>
<td>149.000</td>
<td>6.00000</td>
<td>0.00000</td>
<td>0.00000</td>
<td>0.00000</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div></blockquote>
</div>
</div>
<div class="section" id="usr">
<span id="case-files-usr"></span><h2>usr<a class="headerlink" href="#usr" title="Permalink to this headline">¶</a></h2>
<p>This file implements the the user interface to Nek5000. What follows is a brief description of the available
subroutines.</p>
<div class="section" id="uservp">
<h3>uservp<a class="headerlink" href="#uservp" title="Permalink to this headline">¶</a></h3>
<p>This function can be used  to specify customized or solution dependent material
properties.</p>
<p>Example:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">ifield</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">   </span><span class="n">udiff</span>  <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">temp</span><span class="p">)</span> <span class="c">! dynamic viscosity</span>
   <span class="n">utrans</span> <span class="o">=</span> <span class="mf">1.0</span>              <span class="c">! density</span>
<span class="k">else if</span> <span class="p">(</span><span class="n">ifield</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">   </span><span class="n">udiff</span>  <span class="o">=</span> <span class="mf">1.0</span>              <span class="c">! conductivity</span>
   <span class="n">utrans</span> <span class="o">=</span> <span class="mf">1.0</span>              <span class="c">! rho*cp</span>
<span class="n">endif</span>
</pre></div>
</div>
</div>
<div class="section" id="userf">
<h3>userf<a class="headerlink" href="#userf" title="Permalink to this headline">¶</a></h3>
<p>This functions sets the source term (which will be subsequently be multiplied by
the density) for the momentum equation.</p>
<p>Example:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">parameter</span><span class="p">(</span><span class="n">g</span> <span class="o">=</span> <span class="mf">9.81</span><span class="p">)</span>

<span class="n">ffx</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ffy</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">ffz</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="c">! gravitational acceleration</span>
</pre></div>
</div>
</div>
<div class="section" id="userq">
<h3>userq<a class="headerlink" href="#userq" title="Permalink to this headline">¶</a></h3>
<p>This functions sets the source term for the energy (temperature) and passive scalar equations.</p>
</div>
<div class="section" id="userbc">
<h3>userbc<a class="headerlink" href="#userbc" title="Permalink to this headline">¶</a></h3>
<p>This functions sets boundary conditions. Note, this function is only called
for special boundary condition types and only for points on the boundary surface.</p>
</div>
<div class="section" id="useric">
<h3>useric<a class="headerlink" href="#useric" title="Permalink to this headline">¶</a></h3>
<p>This functions sets the initial conditions.</p>
</div>
<div class="section" id="userchk">
<h3>userchk<a class="headerlink" href="#userchk" title="Permalink to this headline">¶</a></h3>
<p>This is a general purpose function that gets executed before the time stepper and after every time
step.</p>
</div>
<div class="section" id="userqtl">
<h3>userqtl<a class="headerlink" href="#userqtl" title="Permalink to this headline">¶</a></h3>
<p>This function can be used  to specify a cutomzized thermal diveregence for the low Mach solver.
step.</p>
</div>
<div class="section" id="usrdat">
<h3>usrdat<a class="headerlink" href="#usrdat" title="Permalink to this headline">¶</a></h3>
<p>This function can be used to modify the element vertices and is called before the spectral element mesh (GLL points) has been laid out.</p>
</div>
<div class="section" id="usrdat2">
<h3>usrdat2<a class="headerlink" href="#usrdat2" title="Permalink to this headline">¶</a></h3>
<p>This function can be used to modify the spectral element mesh.
The geometry information (mass matrix, surface normals, etc.) will be rebuilt after this routine is called.</p>
</div>
<div class="section" id="usrdat3">
<h3>usrdat3<a class="headerlink" href="#usrdat3" title="Permalink to this headline">¶</a></h3>
<p>This function can be used to initialize case/user specific data.</p>
</div>
</div>
<div class="section" id="size">
<h2>SIZE<a class="headerlink" href="#size" title="Permalink to this headline">¶</a></h2>
<p>SIZE file defines the problem size, i.e. spatial points at which the solution is to be evaluated within each element, number of elements per processor etc.
The SIZE file governs the memory allocation for most of the arrays
in Nek5000, with the exception of those required by the C utilities.
The <em>basic</em> parameters of interest in SIZE are:</p>
<ul class="simple">
<li><strong>ldim</strong> = 2 or 3.  This must be set to 2 for two-dimensional or axisymmetric simulations  (the latter only partially supported) or to 3 for three-dimensional simulations.</li>
<li><strong>lx1</strong> controls the polynomial order of the solution, <span class="math">\(N = {\tt lx1-1}\)</span>.</li>
<li><strong>lxd</strong> controls the polynomial order of the (over-)integration/dealiasing. Strictly speaking <span class="math">\({\tt lxd=3 * lx1/2}\)</span> is required but often smaller values are good enough.</li>
<li><strong>lx2</strong> = <code class="docutils literal"><span class="pre">lx1</span></code> or <code class="docutils literal"><span class="pre">lx1-2</span></code> and is an approximation order for pressure that determines the formulation for the Navier-Stokes  solver (i.e., the choice between the <span class="math">\(\mathbb{P}_N - \mathbb{P}_N\)</span> or <span class="math">\(\mathbb{P}_N - \mathbb{P}_{N-2}\)</span> spectral-element methods).</li>
<li><strong>lelg</strong>, an upper bound on the total number of elements in your mesh.</li>
<li><strong>lpmax</strong>, a maximum number of processors that can be used</li>
<li><strong>lpmin</strong>, a minimum number of processors that can be used (see also  <strong>Memory Requirements</strong>).</li>
<li><strong>ldimt</strong>, an upper bound on a number of auxilary fields to solve (temperature + other scalars, minimum is 1).</li>
</ul>
<p>The <em>optional</em>
upper bounds on parameters in SIZE are (minimum being 1 unless otherwise noted):</p>
<ul class="simple">
<li><strong>lhis</strong>, a maximum history (i.e. monitoring) points.</li>
<li><strong>maxobj</strong>, a maximum number of objects.</li>
<li><strong>lpert</strong>, a maximum perturbations.</li>
<li><strong>toteq</strong>, a maximum number of conserved scalars in CMT (minimum could be 0).</li>
<li><strong>nsessmax</strong>, a maximum number of (ensemble-average) sessions.</li>
<li><strong>lxo</strong>, a maximum number of points per element for field file output (<span class="math">\({\tt lxo \geq lx1}\)</span>).</li>
<li><strong>lelx</strong>, <strong>lely</strong>, <strong>lelz</strong>, a maximum number of element in each direction for global tensor product solver and/or dimentions.</li>
<li><strong>mxprev</strong>, a maximum dimension of projection space (e.g. 20).</li>
<li><strong>lgmres</strong>, a maximum dimension of Krylov space (e.g. 30).</li>
<li><strong>lorder</strong>, a maximum order of temporal discretization (minimum is2 see also characteristic/OIFS method).</li>
<li><strong>lelt</strong> determines the maximum number of elements <em>per processor</em> (should be not smaller than nelgt/lpmin, e.g. lelg/lpmin+1).</li>
<li><strong>lx1m</strong>, a polynomial order for mesh solver that should be equal to lx1 in case of ALE and in case of stress-formulation (=1 otherwise).</li>
<li><strong>lbelt</strong> determines the maximum number of elements per processor for MHD solver that should be equalt to lelt (=1 otherwise).</li>
<li><strong>lpelt</strong> determines the maximum number of elements per processor for linear stability solver that should be equalt to lelt (=1 otherwise).</li>
<li><strong>lcvelt</strong> determines the maximum number of elements per processor for CVODE solver that should be equalt to lelt (=1 otherwise).</li>
<li><strong>lfdm</strong> equals to 1 for global tensor product solver (that uses fast diagonalization method) being 0 otherwise.</li>
</ul>
<p>Note that one also need to include the following line to SIZE file:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">include</span> <span class="s1">&#39;SIZE.inc&#39;</span>
</pre></div>
</div>
<p>that defines addional internal parameters.</p>
</div>
<div class="section" id="map-ma2">
<span id="case-files-ma2"></span><h2>map/ma2<a class="headerlink" href="#map-ma2" title="Permalink to this headline">¶</a></h2>
<p>TODO: Add more details</p>
</div>
<div class="section" id="f-05d">
<span id="case-files-fld"></span><h2>f%05d<a class="headerlink" href="#f-05d" title="Permalink to this headline">¶</a></h2>
<p>TODO: Add fld details</p>
<p>The binary <code class="docutils literal"><span class="pre">.f%05d</span></code> file format is used to write and read data both in serial and parallel
in Nek5000.</p>
<p>The file is composed of:</p>
<blockquote>
<div><ul class="simple">
<li>header</li>
<li>mesh data</li>
<li>field data</li>
<li>bounding box data</li>
</ul>
</div></blockquote>
<p>We will go through each of these categories and give a description of its
composition.</p>
<div class="section" id="id2">
<h3>Header<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The header provides structural information about the stored data that is needed
to parse it correctly. The header is composed of 11 values in ASCII format. It
has a fixed size of 132 bytes and starts with the string <code class="docutils literal"><span class="pre">#std</span></code>. All
header entries are padded to the right. After the header with 132 bytes, 4 bytes
follow that determine the endianess of the binary file.  It is the binary
representation of the number 6.54321 either in little or big endian.</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="12%" />
<col width="17%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Entry</th>
<th class="head">Padding</th>
<th class="head">Name</th>
<th class="head">Short Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1</td>
<td>2</td>
<td><code class="docutils literal"><span class="pre">wdsizo</span></code></td>
<td>sets the precision to 4 or 8</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>3</td>
<td><code class="docutils literal"><span class="pre">nx</span></code></td>
<td>number of coordinates in x direction</td>
</tr>
<tr class="row-even"><td>2</td>
<td>3</td>
<td><code class="docutils literal"><span class="pre">ny</span></code></td>
<td>number of coordinates in y direction</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>3</td>
<td><code class="docutils literal"><span class="pre">nz</span></code></td>
<td>number of coordinates in z direction</td>
</tr>
<tr class="row-even"><td>5</td>
<td>11</td>
<td><code class="docutils literal"><span class="pre">nelo</span></code></td>
<td>number of elements</td>
</tr>
<tr class="row-odd"><td>6</td>
<td>11</td>
<td><code class="docutils literal"><span class="pre">nelgt</span></code></td>
<td><span class="red">—-</span></td>
</tr>
<tr class="row-even"><td>7</td>
<td>21</td>
<td><code class="docutils literal"><span class="pre">time</span></code></td>
<td>time stamp</td>
</tr>
<tr class="row-odd"><td>8</td>
<td>10</td>
<td><code class="docutils literal"><span class="pre">iostep</span></code></td>
<td>time step</td>
</tr>
<tr class="row-even"><td>9</td>
<td>7</td>
<td><code class="docutils literal"><span class="pre">fid0</span></code></td>
<td><span class="red">field id</span></td>
</tr>
<tr class="row-odd"><td>10</td>
<td>7</td>
<td><code class="docutils literal"><span class="pre">nfileoo</span></code></td>
<td><span class="red">number of files</span></td>
</tr>
<tr class="row-even"><td>11</td>
<td>4</td>
<td><code class="docutils literal"><span class="pre">rdcode</span></code></td>
<td>Fields written</td>
</tr>
</tbody>
</table>
<p>Example of a header::</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#std 4  6  6  1         36         36  0.1000000000000E+03     10000     0      1 XUP</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">wdsize</span></code> sets the precision of the floating point numbers in the file. This
is either 4 bytes for floats or 8 bytes for double precision.</p>
<p><code class="docutils literal"><span class="pre">nx</span></code>, <code class="docutils literal"><span class="pre">ny</span></code> and <code class="docutils literal"><span class="pre">nz</span></code> set the number of coordinates in  <span class="math">\(x\)</span>, <span class="math">\(y\)</span> and <span class="math">\(z\)</span>
direction for each element (polynomial order), respectively. <code class="docutils literal"><span class="pre">nelo</span></code> sets
the number of total elements on the mesh.</p>
<p><code class="docutils literal"><span class="pre">time</span></code> is the simulation time while <code class="docutils literal"><span class="pre">iostep</span></code> is the time step when the file was written.</p>
<p><code class="docutils literal"><span class="pre">rdcode</span></code> determines which fields are contained in the file:</p>
<blockquote>
<div><ul class="simple">
<li>X: Geometry</li>
<li>U: Velocity</li>
<li>P: Pressure</li>
<li>T: Temperature</li>
<li>S: Passive scalar</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="data">
<h3>Data<a class="headerlink" href="#data" title="Permalink to this headline">¶</a></h3>
<p>The data field begins after the first 136 bytes of the file. The values are
stored unrolled for each element and for each direction.
Example code for reading the geometry field in python:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">iel</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelo</span><span class="p">):</span>
    <span class="n">x</span><span class="o">=</span><span class="n">ifilebuf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">wdsizo</span><span class="p">)</span>
    <span class="n">xup</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">xfield</span><span class="p">[</span><span class="n">iel</span><span class="p">,:]</span><span class="o">=</span><span class="n">xup</span>
    <span class="n">y</span><span class="o">=</span><span class="n">ifilebuf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">wdsizo</span><span class="p">)</span>
    <span class="n">yup</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
    <span class="n">yfield</span><span class="p">[</span><span class="n">iel</span><span class="p">,:]</span><span class="o">=</span><span class="n">yup</span>
    <span class="k">if</span> <span class="n">if3d</span><span class="p">:</span>
        <span class="n">z</span><span class="o">=</span><span class="n">ifilebuf</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">wdsizo</span><span class="p">)</span>
        <span class="n">zup</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">nxyzo8</span><span class="o">*</span><span class="n">c</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="p">)</span>
        <span class="n">zfield</span><span class="p">[</span><span class="n">iel</span><span class="p">,:]</span><span class="o">=</span><span class="n">zup</span>
</pre></div>
</div>
<p>TODO: Add more details</p>
</div>
</div>
<div class="section" id="boundary-conditions">
<span id="sec-boundary"></span><h2>Boundary Conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this headline">¶</a></h2>
<p>TODO: Update</p>
<p>The boundary conditions can be imposed in various ways:</p>
<ul class="simple">
<li>when the mesh is generated e.g. with <code class="docutils literal"><span class="pre">genbox</span></code>, as will be explained in <a class="reference internal" href="geometry.html#sec-genbox"><span class="std std-ref">Cylindrical/Cartesian-transition Annuli</span></a></li>
<li>when the <code class="docutils literal"><span class="pre">.rea</span></code> file is read in <code class="docutils literal"><span class="pre">prenek</span></code> or directly in the <code class="docutils literal"><span class="pre">.rea</span></code> file</li>
<li>directly in the <code class="docutils literal"><span class="pre">.rea</span></code> file</li>
<li>in the subroutine <code class="docutils literal"><span class="pre">userbc</span></code></li>
</ul>
<p>The general convention for boundary conditions in the <code class="docutils literal"><span class="pre">.rea</span></code> file is</p>
<ul class="simple">
<li>upper case letters correspond to Primitive boundary conditions, as given in <a class="reference internal" href="#tab-primitivebcf"><span class="std std-numref">Table 14</span></a>, <a class="reference internal" href="#tab-primitivebct"><span class="std std-numref">Table 16</span></a></li>
<li>lower case letters correspond to user defined boundary conditions, see <a class="reference internal" href="#tab-userbcf"><span class="std std-numref">Table 15</span></a>, <a class="reference internal" href="#tab-userbct"><span class="std std-numref">Table 17</span></a></li>
</ul>
<p>Since there are no supporting tools that will correctly populate the <code class="docutils literal"><span class="pre">.rea</span></code> file with the appropriate values, temperature, velocity, and flux boundary conditions are typically lower case and values must be specified in the <code class="docutils literal"><span class="pre">userbc</span></code> subroutine in the <code class="docutils literal"><span class="pre">.usr</span></code> file.</p>
<div class="section" id="fluid-velocity">
<h3>Fluid Velocity<a class="headerlink" href="#fluid-velocity" title="Permalink to this headline">¶</a></h3>
<p>Two types of boundary conditions are applicable to the
fluid velocity : essential (Dirichlet) boundary
condition in which the velocity is specified;
natural (Neumann) boundary condition in which the traction
is specified.
For segments that constitute the boundary <span class="math">\(\partial \Omega_f\)</span>, see <a class="reference internal" href="theory.html#fig-walls"><span class="std std-numref">Fig. 9</span></a>,
one of these two types of boundary conditions must be
assigned to each component of the fluid velocity.
The fluid boundary condition can be <em>all Dirichlet</em>
if all velocity components of <span class="math">\({\bf u}\)</span> are
specified; or it can be <em>all Neumann</em> if all traction components
<span class="math">\({\bf t} = [-p {\bf I} + \mu (\nabla {\bf u} +
(\nabla {\bf u})^{T})] \cdot {\bf n}\)</span>, where
<span class="math">\({\bf I}\)</span> is the identity tensor, <span class="math">\({\bf n}\)</span> is the unit normal
and <span class="math">\(\mu\)</span> is the dynamic viscosity, are specified;
or it can be <em>mixed Dirichlet/Neumann</em>
if Dirichlet and Neumann conditions are selected for different
velocity components.
Examples for all Dirichlet, all Neumann and mixed Dirichhlet/Neumann
boundaries are wall, free-surface and symmetry, respectively.
If the nonstress formulation is selected, then traction
is not defined on the boundary.
In this case, any Neumann boundary condition imposed must be homogeneous;
i.e., equal to zero.
In addition, mixed Dirichlet/Neumann boundaries must be aligned with
one of the Cartesian axes.</p>
<p>For flow geometry which consists of
a periodic repetition of a particular geometric unit,
the periodic boundary conditions can be imposed,
as illustrated in <a class="reference internal" href="theory.html#fig-walls"><span class="std std-numref">Fig. 9</span></a>.</p>
<span id="tab-primitivebcf"></span><table border="1" class="docutils" id="id20">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Primitive boundary conditions</span><a class="headerlink" href="#id20" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="29%" />
<col width="34%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Identifier</th>
<th class="head">Description</th>
<th class="head">Parameters</th>
<th class="head">No of Parameters</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>P</td>
<td>periodic</td>
<td>periodic element and face</td>
<td>2</td>
</tr>
<tr class="row-odd"><td>V</td>
<td>Dirichlet velocity</td>
<td>u,v,w</td>
<td>3</td>
</tr>
<tr class="row-even"><td>O</td>
<td>outflow</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-odd"><td>W</td>
<td>wall (no slip)</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td>F</td>
<td>flux</td>
<td>flux</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>SYM</td>
<td>symmetry</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td>A</td>
<td>axisymmetric boundary</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-odd"><td>MS</td>
<td>moving boundary</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td>ON</td>
<td>Outflow, Normal</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-odd"><td>E</td>
<td>Interior boundary</td>
<td>Neighbour element ID</td>
<td>2</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span id="tab-userbcf"></span><table border="1" class="docutils" id="id21">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">User defined boundary conditions</span><a class="headerlink" href="#id21" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Indentifier</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>v</td>
<td>user defined Dirichlet velocity</td>
</tr>
<tr class="row-odd"><td>t</td>
<td>user defined Dirichlet temperature</td>
</tr>
<tr class="row-even"><td>f</td>
<td>user defined flux</td>
</tr>
</tbody>
</table>
<p>The open(outflow) boundary condition (“O”) arises as a natural boundary condition from the variational formulation of Navier Stokes. We identify two situations</p>
<ul>
<li><p class="first">In the non-stress formulation, open boundary condition (‘Do nothing’)</p>
<div class="math">
\[[-p{\bf I} + \nu(\nabla {\bf u})]\cdot {\bf n}=0\]</div>
</li>
<li><p class="first">In the stress formulation, free traction boundary condition</p>
<div class="math">
\[[-p{\bf I} + \nu(\nabla {\bf u}+\nabla {\bf u}^T)]\cdot {\bf n}=0\]</div>
</li>
<li><p class="first">the symmetric boundary condition (“SYM”) is given as</p>
<div class="math">
\[\begin{split}{\bf u} \cdot {\bf n} &amp;= 0\ ,\\
(\nabla {\bf u} \cdot {\bf t})\cdot {\bf n} &amp;= 0\end{split}\]</div>
<p>where <span class="math">\({\bf n}\)</span> is the normal vector and <span class="math">\({\bf t}\)</span> the tangent vector. If the normal and tangent vector are not aligned with the mesh the stress formulation has to be used.</p>
</li>
<li><p class="first">the periodic boundary condition (“P”) needs to be prescribed in the <code class="docutils literal"><span class="pre">.rea</span></code> file since it already assigns the last point to first via <span class="math">\({\bf u}({\bf x})={\bf u}({\bf x} + L)\)</span>, where <span class="math">\(L\)</span> is the periodic length.</p>
</li>
<li><p class="first">the wall boundary condition (“W”) corresponds to <span class="math">\({\bf u}=0\)</span>.</p>
</li>
</ul>
<p>For a fully-developed flow in such a configuration, one can
effect great computational efficiencies by considering the
problem in a single geometric unit (here taken to be of
length <span class="math">\(L\)</span>), and requiring periodicity of the field variables.
Nek5000 requires that the pairs of sides (or faces, in
the case of a three-dimensional mesh) identified as periodic
be identical (i.e., that the geometry be periodic).</p>
<p>For an axisymmetric flow geometry, the axis boundary
condition is provided for boundary segments that lie
entirely on the axis of symmetry.
This is essentially a symmetry (mixed Dirichlet/Neumann)
boundary condition
in which the normal velocity and the tangential traction
are set to zero.</p>
<p>For free-surface boundary segments, the inhomogeneous
traction boundary conditions
involve both the surface tension coefficient <span class="math">\(\sigma\)</span>
and the mean curvature of the free surface.</p>
</div>
<div class="section" id="passive-scalars-and-temperature">
<h3>Passive scalars and Temperature<a class="headerlink" href="#passive-scalars-and-temperature" title="Permalink to this headline">¶</a></h3>
<p>The three types of boundary conditions applicable to the
temperature are: essential (Dirichlet) boundary
condition in which the temperature is specified;
natural (Neumann) boundary condition in which the heat flux
is specified; and mixed (Robin) boundary condition
in which the heat flux is dependent on the temperature
on the boundary.
For segments that constitute the boundary
<span class="math">\(\partial \Omega_f' \cup \partial \Omega_s'\)</span> (refer to Fig. 2.1),
one of the above three types of boundary conditions must be
assigned to the temperature.</p>
<p>The two types of Robin boundary condition for temperature
are: convection boundary conditions for which the heat
flux into the domain depends on the heat transfer coefficient
<span class="math">\(h_{c}\)</span> and the difference between the environmental temperature
<span class="math">\(T_{\infty}\)</span> and the surface temperature; and radiation
boundary conditions for which the heat flux into the domain
depends on the Stefan-Boltzmann constant/view-factor
product <span class="math">\(h_{rad}\)</span> and the difference between the fourth power
of the environmental temperature <span class="math">\(T_{\infty}\)</span> and the fourth
power of the surface temperature.</p>
<span id="tab-primitivebct"></span><table border="1" class="docutils" id="id22">
<caption><span class="caption-number">Table 16 </span><span class="caption-text">Primitive boundary conditions (Temperature and Passive scalars)</span><a class="headerlink" href="#id22" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="48%" />
<col width="15%" />
<col width="22%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Identifier</th>
<th class="head">Description</th>
<th class="head">Parameters</th>
<th class="head">No of Parameters</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>T</td>
<td>Dirichlet temperature/scalar</td>
<td>value</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>outflow</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td>P</td>
<td>periodic boundary</td>
<td><code class="docutils literal"><span class="pre">-</span></code></td>
<td>0</td>
</tr>
<tr class="row-odd"><td>I</td>
<td>insulated (zero flux) for temperature</td>
<td>&#160;</td>
<td>0</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span id="tab-userbct"></span><table border="1" class="docutils" id="id23">
<caption><span class="caption-number">Table 17 </span><span class="caption-text">User defined boundary conditions (Temperature and Passive scalars)</span><a class="headerlink" href="#id23" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Identifier</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>t</td>
<td>user defined Dirichlet temperature</td>
</tr>
<tr class="row-odd"><td>c</td>
<td>Newton cooling</td>
</tr>
<tr class="row-even"><td>f</td>
<td>user defined flux</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">open boundary condition (“O”)</p>
<div class="math">
\[k(\nabla T)\cdot {\bf n} =0\]</div>
</li>
<li><p class="first">insulated boundary condition (“I”)</p>
<div class="math">
\[k(\nabla T)\cdot {\bf n} =0\]</div>
<p>where <span class="math">\({\bf n}\)</span> is the normal vector and <span class="math">\({\bf t}\)</span> the tangent vector. If the normal and tangent vector are not aligned with the mesh the stress formulation has to be used.</p>
</li>
<li><p class="first">the periodic boundary condition (“P”) needs to be prescribed in the <code class="docutils literal"><span class="pre">.rea</span></code> file since it already assigns the last point to first via <span class="math">\({\bf u}({\bf x})={\bf u}({\bf x} + L)\)</span>, where <span class="math">\(L\)</span> is the periodic length.</p>
</li>
<li><p class="first">Newton cooling boundary condition (“c”)</p>
<div class="math">
\[k(\nabla T)\cdot {\bf n}=h(T-T_{\infty})\]</div>
</li>
<li><p class="first">flux boundary condition (“f”)</p>
<div class="math">
\[k(\nabla T)\cdot {\bf n} =f\]</div>
</li>
</ul>
</div>
<div class="section" id="passive-scalars">
<h3>Passive scalars<a class="headerlink" href="#passive-scalars" title="Permalink to this headline">¶</a></h3>
<p>The boundary conditions for the passive scalar fields
are analogous to those used for the temperature field.
Thus, the temperature boundary condition
menu will reappear for each passive scalar field so that the
user can specify an independent set of boundary conditions
for each passive scalar field.</p>
</div>
<div class="section" id="internal-boundary-conditions">
<h3>Internal Boundary Conditions<a class="headerlink" href="#internal-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>In the spatial discretization, the entire computational
domain is subdivided into macro-elements, the boundary
segments shared by any two of these macro-elements
in <span class="math">\(\Omega_f\)</span> and <span class="math">\(\Omega_s\)</span> are denoted as internal boundaries.
For fluid flow analysis with a single-fluid system or heat
transfer analysis without change-of-phase, internal
boundary conditions are irrelevant as the corresponding
field variables on these segments are part of the
solution. However, for a multi-fluid system and for
heat transfer analysis with change-of-phase, special
conditions are required at particular internal
boundaries, as described in the following.</p>
<p>For a fluid system composes of multiple immiscible fluids,
the boundary (and hence the identity) of each fluid must
be tracked, and a jump in the normal traction exists
at the fluid-fluid interface if the surface tension
coefficient is nonzero.
For this purpose, the interface between any two fluids
of different identity must be defined as a special type of
internal boundary, namely, a fluid layer;
and the associated surface tension coefficient also
needs to be specified.</p>
<p>In a heat transfer analysis with change-of-phase, Nek5000 assumes
that both phases exist at the start of the solution, and that
all solid-liquid interfaces are specified as special internal
boundaries, namely, the melting fronts.
If the fluid flow problem is considered, i.e., the energy
equation is solved in conjunction with the momentum and
continuity equations, then only
the common boundary between the fluid and the solid
(i.e., all or portion of <span class="math">\(\partial \overline{\Omega}_f'\)</span> in <a class="reference internal" href="theory.html#fig-walls"><span class="std std-numref">Fig. 9</span></a>)
can be defined as the melting front.
In this case, segments on <span class="math">\(\partial \overline{\Omega}_f'\)</span> that
belong to the dynamic melting/freezing interface need to be
specified by the user.
Nek5000 always assumes that the density of the two phases
are the same (i.e., no Stefan flow); therefore at the melting
front, the boundary condition for the fluid velocity is the
same as that for a stationary wall, that is, all velocity
components are zero.
If no fluid flow is considered, i.e., only the energy equation
is solved, then any internal boundary can be defined as
a melting front.
The temperature boundary condition at the melting front
corresponds to a Dirichlet
condition; that is, the entire segment maintains a constant temperature
equal to the user-specified melting temperature <span class="math">\(T_{melt}\)</span>
throughout the solution.
In addition, the volumetric latent heat of fusion <span class="math">\(\rho L\)</span>
for the two phases,
which is also assumed to be constant, should be specified.</p>
</div>
</div>
<div class="section" id="history-points">
<span id="case-files-his"></span><h2>History Points<a class="headerlink" href="#history-points" title="Permalink to this headline">¶</a></h2>
<p>Assuming a case named <code class="docutils literal"><span class="pre">foo</span></code>, a list of monitor points can be defined in file <code class="docutils literal"><span class="pre">foo.his</span></code> to evaluate velocity, temperature, pressure and passive scalars.
Values for each scalar will be spectrally interpolated to each point and appended to this file each time the subroutine <code class="docutils literal"><span class="pre">hpts()</span></code> is called.
Depending on the number of monitoring points you may need to increase parameter <code class="docutils literal"><span class="pre">lhis</span></code> in SIZE.
Usage example:</p>
<ul>
<li><p class="first">setup an ASCII file called <code class="docutils literal"><span class="pre">foo.his</span></code>, e.g.:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>3 !number of monitoring points
1.1 -1.2 1.0
. . .
x y z
</pre></div>
</div>
</li>
<li><p class="first">add <code class="docutils literal"><span class="pre">call</span> <span class="pre">hpts()</span></code> to <code class="docutils literal"><span class="pre">userchk()</span></code></p>
</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="theory.html" class="btn btn-neutral float-right" title="Theory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorials/neknek.html" class="btn btn-neutral" title="Overlapping Overset Grids" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, UCHICAGO ARGONNE, LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'17.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>